extensions:
  - addsTo:
      pack: codeql/python-all
      extensible: sourceModel
    data:
      - ["quickapi.request.Request","Member[get_query_param].ReturnValue","remote"]
      - ["quickapi.request.Request","Member[get_all_query_params].ReturnValue","remote"]
      - ["quickapi.request.Request","Member[get_header].ReturnValue","remote"]
      - ["quickapi.request.Request","Member[get_json_body].ReturnValue","remote"]
      - ["quickapi.request.Request","Member[get_raw_body].ReturnValue","remote"]
      - ["quickapi.request.Request","Member[get_form_field].ReturnValue","remote"]
      - ["quickapi.request.Request","Member[get_cookie].ReturnValue","remote"]
      - ["quickapi.request.Request","Member[get_uploaded_filename].ReturnValue","remote"]
      - ["quickapi.security.TokenValidator","Member[decode_token].ReturnValue","remote"]
      - ["quickapi.security.TokenValidator","Member[get_user_id].ReturnValue","remote"]

  - addsTo:
      pack: codeql/python-all
      extensible: sinkModel
    data:
      - ["quickapi.database.DatabaseConnection","Member[execute_query].Argument[0,sql:]","sql-injection"]
      - ["quickapi.database.DatabaseConnection","Member[execute_update].Argument[0,sql:]","sql-injection"]
      - ["quickapi.database.DatabaseConnection","Member[execute_raw].Argument[0,sql:]","sql-injection"]
      - ["quickapi.security.SystemHelper","Member[run_command].Argument[0,cmd:]","command-injection"]
      - ["quickapi.security.SystemHelper","Member[ping_host].Argument[0,hostname:]","command-injection"]
      - ["quickapi.security.SystemHelper","Member[read_file].Argument[0,filepath:]","path-injection"]
      - ["quickapi.security.SystemHelper","Member[write_log].Argument[1,message:]","log-injection"]
      - ["quickapi.templating.TemplateEngine","Member[render_string].Argument[0,template_str:]","html-injection"]
      - ["quickapi.response.Response","Member[redirect].Argument[0,url:]","url-redirection"]

  - addsTo:
      pack: codeql/python-all
      extensible: summaryModel
    data:
      - ["quickapi.security.Sanitizer","Member[strip_tags]","Argument[0,html:]","ReturnValue","taint"]
      - ["quickapi.security.Sanitizer","Member[truncate]","Argument[0,value:]","ReturnValue","taint"]
      - ["quickapi.security.Sanitizer","Member[to_lowercase]","Argument[0,value:]","ReturnValue","taint"]
      - ["quickapi.utils.DataTransformer","Member[to_json]","Argument[0,data:]","ReturnValue","taint"]
      - ["quickapi.utils.DataTransformer","Member[from_json]","Argument[0,json_str:]","ReturnValue","taint"]
      - ["quickapi.utils.DataTransformer","Member[format_string]","Argument[0,template:]","ReturnValue","taint"]
      - ["quickapi.utils.DataTransformer","Member[format_string]","Argument[1..]","ReturnValue","taint"]
      - ["quickapi.utils.DataTransformer","Member[join_strings]","Argument[0,parts:]","ReturnValue","taint"]
      - ["quickapi.database.QueryBuilder","Member[select]","Argument[self]","ReturnValue","taint"]
      - ["quickapi.database.QueryBuilder","Member[where_raw]","Argument[0,condition:]","ReturnValue","taint"]
      - ["quickapi.database.QueryBuilder","Member[where_raw]","Argument[self]","ReturnValue","taint"]
      - ["quickapi.database.QueryBuilder","Member[build]","Argument[self]","ReturnValue","taint"]

  - addsTo:
      pack: codeql/python-all
      extensible: neutralModel
    data: []

  - addsTo:
      pack: codeql/python-all
      extensible: typeModel
    data: []
